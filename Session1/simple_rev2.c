#include <stdio.h>
#include <string.h>

int fakeCheckPass(char*);
int checkPassJoke(char*);
int checkPass(char*);
void printHint();
void printSuccess();

int main(int argc, char** argv){

	if(argc < 2){
		printf("Usage: ./rev2 PASSWORD\n");
		return -1;
	}

	char test[] = "Let's see if you gave me the write password.\n";

	if(fakeCheckPass(argv[0]) || checkPassJoke(argv[1])){
		printHint();
	}
	else{
		printf("I bet you couldn't even reverse a palindrome!!\n"); 
	}

	if(argc > 2){
		if(checkPass(argv[2])){
			printSuccess();
		}
		else{
			printf("I find your lack of flag ... DISTURBING\n");
		}
	}
	return 0;
}


int fakeCheckPass(char* program){
	if(!strcmp(program, "You thought this was the flag, but it was me! Your executable!")){
		printf("If you are getting this message, tell me how you did it and extra points to you.\n");
		return 1;
	}
	else return 0;
}

int checkPassJoke(char* maybepass){

	for(int i = 0; i < strlen(maybepass); i++){
		maybepass[i] = maybepass[i] - 1;
	}

	if(!strcmp(maybepass, "e`jdzo`rrvnqc|")){  //Should be fake{password}
		return 1;
	}
	else return 0;
}

int checkPass(char* pass){
	for(int i = 0; i < strlen(pass); i++){
                pass[i] = pass[i] + 1;
        }

        for(int i = 0; i < strlen(pass); i++){
                pass[i] = pass[i] ^ 2;
        }

	if(!strcmp(pass, "eo`j~g3bxrTbo0n6bqdudqvhmjB|")){
		return 1; //Should be flag{d0_yoU_l1k3_reversing?}
	}

	else return 0;

}

void printHint(){
	printf("59 6F 75 20 74 68 6F 75 67 68 74 20 74 68 61 74 20 77 61 73 20 74 68 65 20 70 61 73 73 77 6F 72 64 3F 20 59 6F 75 20 6E 65 65 64 20 74 6F 20 72 65 76 65 72 73 65 20 6D 6F 72 65 2E 20 48 65 72 65 20 69 73 20 61 20 68 69 6E 74 20 74 68 6F 75 67 68 3A 0A 55 73 61 67 65 20 6C 69 65 73 2E");
	return;
}

void printSuccess(){
	char string[] = "\x41\x6D\x70\x70\x63\x61\x72\x1F\x1E\x57\x6D\x73\x1E\x70\x63\x74\x63\x70\x71\x63\x62\x1E\x72\x66\x63\x1E\x64\x6A\x5F\x65\x1F";
	for(int i = 0; i < strlen(string); i++){
		printf("%c", (char)(string[i] + 0x02));
	}
	printf("\n");
}

