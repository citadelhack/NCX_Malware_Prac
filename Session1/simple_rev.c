#include <stdio.h>
#include <string.h>
void printMenu();
void tellJoke();
void changeName(char*);
int passwordCheck();

int main(void){

	unsigned int choice;
	char name[64] = "Human";
	while(1){
		printf("\n\n\n********************************\n");
		printf("Greetings and Salutations %s\n", name); 
		printf("********************************\n");
		printMenu();
		scanf("%u", &choice);
		choice = choice % 4;
		if(choice == 1){
			tellJoke();
		}
		else if(choice == 2){
			changeName(name);
		}
		else if(choice == 3){
			if(passwordCheck()){
				printf("You are a reversing stud modivator!\n");
			}
			else{
				printf("You are so bad at reversing you still mess up about face.\n");
			}
		}
		else{
			printf("Goodbye!");
			return 0;
		}
		
	}
}

void printMenu(){
	printf("1. Hear a joke\n");
	printf("2. Choose a name\n");
	printf("3. Enter password\n");
	printf("4. Exit\n");
	printf("\nEnter your choice: ");
}

void tellJoke(){
	getc(stdin);
	printf("How does a computer get Drunk?\n");
	getc(stdin);
	printf("49 74 20 74 61 6b 65 73 20 73 63 72 65 65 6e 73 68 6f 74 73 2e\n");
	printf("Figure it out nerds.\n");
}

void changeName(char* name){
	getc(stdin);
	printf("Enter your new name: ");
	fgets(name, 64, stdin);
	printf("Name Updated!\n");
}

int passwordCheck(){
	getc(stdin);
	char passBuf[265] = {0};
	printf("Enter the password: "); //Should be flag{r3v3rsing_X0r_is_e45y!}
	fgets(passBuf, 256, stdin);
	passBuf[strlen(passBuf) - 1] = 0;
	printf("%u\n", strlen(passBuf));
	if(strlen(passBuf) != 28){
		return 0;
	}
	for(int i = 0; i < 28; i++){
		passBuf[i] = passBuf[i] ^ 3;
	}
	printf("%s", passBuf);
	return !strcmp(passBuf, "eobdxq0u0qpjmd\\[3q\\jp\\f76z\"~");
}

			
